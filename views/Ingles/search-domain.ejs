<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Search Domain - NameGasmic</title>
  <style>
    /* Cards / Pricing */
    .pricing-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 10px;
      margin: 20px auto;   /* centered */
      width: 100%;
      max-width: 900px;    /* same as ES */
    }
    .card { background: linear-gradient(135deg, #1e3c72, #2a5298); border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); padding: 20px; text-align: center; transition: transform .2s; }
    .card:hover { transform: translateY(-5px); }
    .card h2 { margin: 0; font-size: 16px; color: #fff; }
    .price { font-size: 18px; font-weight: bold; margin: 15px 0; color: #ffd700; }
    .desc { font-size: 12px; margin-bottom: 20px; color: #f0f0f0; }
    .btn, .btn a { display:inline-block; padding:10px 20px; background:#ffd700; color:#0d1b3a; font-weight:bold; border-radius:8px; text-decoration:none; transition:background .3s; border:none; cursor:pointer; }
    .btn:hover { background:#ffcc00; }

    /* Page */
    body { margin:0; font-family: Arial, sans-serif; background-color:#0d1b3a; color:white; display:flex; flex-direction:column; min-height:100vh; }
    header { background-color:#0d1b3a; padding:1rem; text-align:center; border-bottom:2px solid #142952; }
    main { flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:1rem; width:100%; max-width:900px; margin:0 auto; }
    h2 { margin-bottom:1rem; }

    /* Search */
    .search-box { display:flex; max-width:500px; width:100%; }
    .search-box input { flex:1; padding:0.75rem; font-size:1rem; border:none; border-radius:8px 0 0 8px; outline:none; }
    .btn-search { background-color:#ff9900; border:none; color:white; padding:0 1.5rem; font-size:1rem; cursor:pointer; border-radius:0 8px 8px 0; transition: background-color .3s; }
    .btn-search:hover { background-color:#e68a00; }

    .result { margin-top:1.5rem; font-size:1.1rem; }
    footer { background-color:#0d1b3a; text-align:center; padding:1rem; border-top:2px solid #142952; font-size:0.9rem; color:#ccc; }
  </style>
</head>
<body>

  <!-- Language switch (EN -> ES) -->
  <div style="position:fixed; top:15px; right:50px; z-index:9999; display:flex; gap:10px;">
    <a href="/es/esp-search-domain" title="EspaÃ±ol">
      <img src="/bandera-es.png" alt="EspaÃ±ol" style="width:60px; height:50px; cursor:pointer;">
    </a>
  </div>

  <header>
    <h1>NameGasmic â€” Search Domain</h1>
  </header>

  <main>
    <h2>Enter your domain</h2>

    <div class="search-box">
      <input type="text" id="domainInput" placeholder="e.g. example.com" />
      <button class="btn-search" id="btnSearch">Search</button>
    </div>

    <div style="margin-top: 1rem;">
      <button class="btn" onclick="window.location.href='/en/namegasm-pagina-inicial-basica'">Go Back</button>
    </div>

    <div id="result" class="result"></div>

    <div class="pricing-container">
      <div class="card">
        <h2>Basic</h2>
        <p class="price">Free</p>
        <p class="desc">Limited domain name searches per day (3 daily).</p>
        <a href="#" class="btn select-plan" data-plan="basic">Start</a>
      </div>

      <div class="card">
        <h2>Premium</h2>
        <p class="price">6 â‚¬/month</p>
        <p class="desc">Unlimited searches, history, and personalized suggestions.</p>
        <a href="#" class="btn select-plan" data-plan="premium">Subscribe</a>
      </div>

      <div class="card">
        <h2>Domains</h2>
        <p class="price">From 66 â‚¬/year</p>
        <p class="desc">Register your domain in multiple new and classic extensions.</p>
        <a href="#" class="btn select-plan" data-plan="domains">Register</a>
      </div>
    </div>
  </main>

  <!-- Chatbot -->
  <div id="chatbot-container" style="position:fixed; bottom:3px; right:20px; z-index:9999;">
    <button id="chatbot-toggle" style="background:#0073e6; color:#fff; border:none; padding:12px 18px; border-radius:50px; cursor:pointer; box-shadow:0px 4px 8px rgba(0,0,0,0.2);">
      ðŸ’¬ Chat
    </button>
    <div id="chatbot-box" style="display:none; width:300px; height:400px; background:#fff; border-radius:12px; box-shadow:0px 4px 10px rgba(0,0,0,0.3); position:absolute; bottom:60px; right:0; overflow:hidden;">
      <div style="background:#0073e6; color:white; padding:10px; font-weight:bold;">Assistant</div>
      <div id="chatbot-messages" style="height:300px; overflow-y:auto; padding:10px; font-size:14px;"></div>
      <div style="display:flex; border-top:1px solid #ccc;">
        <input type="text" id="chatbot-input" placeholder="Write here..." style="flex:1; border:none; padding:10px; font-size:14px;">
        <button id="chatbot-send" style="background:#0073e6; color:#fff; border:none; padding:10px; cursor:pointer;">âž¤</button>
      </div>
    </div>
  </div>

  <footer>
    &copy; 2025 NameGasmic. All rights reserved.
  </footer>

  <script>
    // Validate domain
    function isValidDomain(d) {
      const s = (d || "").trim().toLowerCase();
      if (!s || s.length > 253 || s.includes("..")) return false;
      const re = /^([a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)(\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)+$/i;
      return re.test(s);
    }

    // Real search (unlimited endpoint)
    async function searchDomain() {
      const input = document.getElementById('domainInput');
      const resultDiv = document.getElementById('result');
      const domain = input.value.trim();

      if (!isValidDomain(domain)) {
        resultDiv.textContent = "Please enter a valid domain (e.g. example.com).";
        resultDiv.style.color = "yellow";
        return;
      }

      resultDiv.textContent = "Checkingâ€¦";
      resultDiv.style.color = "#fff";

      try {
        const response = await fetch("/api/search-domain", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ domain })
        });

        const data = await response.json().catch(()=>({}));

        if (response.ok) {
          const availabilityText = data.available ? "Available" : "Not available";
          resultDiv.innerHTML = `
            <div>Domain: <strong>${data.domain}</strong></div>
            <div>Status: <strong style="color:${data.available ? 'lightgreen' : 'red'}">${availabilityText}</strong></div>
          `;
        } else {
          resultDiv.textContent = (data && data.error) ? data.error : "Search error.";
          resultDiv.style.color = "red";
        }
      } catch (err) {
        console.error("Error:", err);
        resultDiv.textContent = "Server not available.";
        resultDiv.style.color = "red";
      }
    }

    document.getElementById('btnSearch').addEventListener('click', searchDomain);
    document.getElementById('domainInput').addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') { e.preventDefault(); searchDomain(); }
    });

    // CTAs â†’ save plan then go to checkout (EN)
    (function(){
      const links = document.querySelectorAll('.select-plan');
      links.forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          const plan = a.getAttribute('data-plan') || 'basic';
          localStorage.setItem('ng_selected_plan', plan);
          window.location.href = '/en/checkout';
        });
      });
    })();

    // Chatbot behavior
    (function(){
      const toggle = document.getElementById("chatbot-toggle");
      const box = document.getElementById("chatbot-box");
      const input = document.getElementById("chatbot-input");
      const send = document.getElementById("chatbot-send");
      const messages = document.getElementById("chatbot-messages");
      if(!toggle || !box) return;
      toggle.addEventListener("click", () => {
        box.style.display = (box.style.display === "none" || !box.style.display) ? "block" : "none";
      });
      function addMsg(who, text){
        const wrap = document.createElement('div');
        wrap.style.marginBottom = '10px';
        wrap.innerHTML = "<strong>"+who+":</strong> " + text;
        messages.appendChild(wrap);
        messages.scrollTop = messages.scrollHeight;
      }
      send.addEventListener("click", () => {
        const text = (input.value || "").trim();
        if(!text) return;
        addMsg('You', text);
        addMsg('Bot', 'Thanks! Weâ€™ll get back to you soon.');
        input.value = "";
      });
    })();
  </script>
</body>
</html>
