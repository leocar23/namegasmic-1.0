<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Iniciar sesi√≥n - NameGasm</title>
  <meta name="description" content="Accede a tu cuenta de NameGasm para gestionar dominios y servicios web de forma segura." />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{
      --bg1:#0d1b3a;
      --bg2:#1b2a59;
      --brand:#0073e6;
      --accent:#ffcc00;
      --text:#ffffff;
      --card:rgba(0,0,0,0.7);
      --error:#ff4d4f;
      --ok:#2ecc71;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, var(--bg1), var(--bg2));
      color: var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
    }

    /* Selector de idioma */
    .lang{
      position:fixed; top:25px; right:35px; z-index:9999;
      display:flex; gap:10px;
    }
    .lang img{ width:60px; height:50px; cursor:pointer; display:block; }

    /* Tarjeta */
    .login-container{
      width:100%;
      max-width:420px;
      background:var(--card);
      padding:36px 28px;
      border-radius:12px;
      box-shadow:0 8px 20px rgba(0,0,0,0.5);
    }
    .login-container h1{
      margin:0 0 18px;
      text-align:center;
      font-size:1.9rem;
      color:var(--accent);
    }
    .subtitle{
      text-align:center;
      margin-top:-6px;
      margin-bottom:18px;
      opacity:.9;
      font-size:.95rem;
    }

    label{
      display:block;
      font-size:.9rem;
      margin:10px 0 6px;
    }
    .field{
      position:relative;
    }
    input[type="email"],
    input[type="password"]{
      width:100%;
      padding:12px 44px 12px 14px; /* espacio para iconos/bot√≥n ojo */
      border:none;
      border-radius:8px;
      font-size:1rem;
    }
    .input-icon{
      position:absolute; right:12px; top:50%; transform:translateY(-50%);
      pointer-events:none; opacity:.7;
    }
    .toggle-pass{
      position:absolute; right:36px; top:50%; transform:translateY(-50%);
      background:transparent; border:none; cursor:pointer; color:#333;
      font-size:1rem; padding:4px; opacity:.8;
    }

    .remember-forgot{
      display:flex; align-items:center; justify-content:space-between;
      gap:8px; margin-top:10px;
      font-size:.9rem;
    }
    .remember-forgot a{
      color:var(--accent); text-decoration:none;
    }
    .remember-forgot a:hover{ text-decoration:underline; }

    .btn{
      width:100%;
      padding:12px;
      margin-top:16px;
      border:none;
      border-radius:50px;
      background:var(--accent);
      color:var(--brand);
      font-weight:bold;
      font-size:1rem;
      cursor:pointer;
      transition: transform .2s, box-shadow .2s, opacity .2s;
    }
    .btn:hover{ transform:translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.3); }
    .btn[disabled]{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }

    .links{
      text-align:center; margin-top:14px; font-size:.95rem;
    }
    .links a{ color:var(--accent); text-decoration:none; }
    .links a:hover{ text-decoration:underline; }

    .alert{
      margin-top:10px;
      padding:10px 12px;
      border-radius:8px;
      background:rgba(255,77,79,.12);
      color:#ffd7d7;
      border:1px solid rgba(255,77,79,.4);
      display:none;
      font-size:.9rem;
    }
    .alert.ok{
      background:rgba(46,204,113,.12);
      border-color:rgba(46,204,113,.4);
      color:#e3ffe3;
    }

    /* Chat */
    #chatbot-container{ position:fixed; bottom:20px; right:20px; z-index:9999; }
    #chatbot-toggle{
      background:var(--brand); color:#fff; border:none;
      padding:12px 18px; border-radius:50px; cursor:pointer;
      box-shadow:0 4px 8px rgba(0,0,0,0.2);
    }
    #chatbot-box{
      display:none; width:300px; height:400px; background:#fff; color:#0d1b3a;
      border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.3);
      position:absolute; bottom:60px; right:0; overflow:hidden;
    }
    .chat-header{ background:var(--brand); color:#fff; padding:10px; font-weight:bold; }
    #chatbot-messages{ height:300px; overflow-y:auto; padding:10px; font-size:14px; }
    .chat-input-row{ display:flex; border-top:1px solid #ccc; }
    .chat-input-row input{ flex:1; border:none; padding:10px; font-size:14px; }
    .chat-input-row button{ background:var(--brand); color:#fff; border:none; padding:10px; cursor:pointer; }
  </style>
</head>
<body>

  <!-- Selector de idioma (est√°tico con .html) -->
  <div class="lang" aria-label="Selector de idioma">
    <a href="sign-in.html" title="English version">
      <img src="/img/bandera-uk.png" alt="English">
    </a>
  </div>

  <main class="login-container" role="main" aria-labelledby="title">
    <h1 id="title">Iniciar sesi√≥n</h1>
    <p class="subtitle">Bienvenido de nuevo. Ingresa para continuar.</p>

    <!-- Mensajes -->
    <div id="form-alert" class="alert" role="alert" aria-live="polite"></div>

    <form id="signin-form" novalidate>
      <label for="email">Correo electr√≥nico</label>
      <div class="field">
        <input
          id="email"
          name="email"
          type="email"
          inputmode="email"
          placeholder="tu@ejemplo.com"
          required
          autocomplete="email"
          aria-describedby="emailHelp"
        />
        <i class="fa-solid fa-envelope input-icon" aria-hidden="true"></i>
      </div>
      <small id="emailHelp" style="opacity:.85;">Usa el correo con el que te registraste.</small>

      <label for="password">Contrase√±a</label>
      <div class="field">
        <input
          id="password"
          name="password"
          type="password"
          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
          required
          minlength="6"
          autocomplete="current-password"
        />
        <button class="toggle-pass" type="button" aria-label="Mostrar u ocultar contrase√±a">
          <i class="fa-regular fa-eye"></i>
        </button>
        <i class="fa-solid fa-lock input-icon" aria-hidden="true"></i>
      </div>

      <div class="remember-forgot">
        <label style="display:flex; align-items:center; gap:8px;">
          <input type="checkbox" id="remember" name="remember" />
          Recu√©rdame
        </label>
        <!-- Para sitio est√°tico: usa .html -->
        <a href="esp-forgot-password.html">¬øOlvidaste tu contrase√±a?</a>
      </div>

      <button id="submit-btn" class="btn" type="submit">
        <i class="fa-solid fa-right-to-bracket"></i> Iniciar sesi√≥n
      </button>
    </form>

    <div class="links">
      ¬øA√∫n no tienes cuenta?
      <!-- Para sitio est√°tico: usa .html -->
      <a href="esp-sign-up.html">Crear cuenta nueva</a>
    </div>
  </main>

  <!-- Chatbot Universal (es) -->
  <div id="chatbot-container">
    <button id="chatbot-toggle">üí¨ Chat</button>
    <div id="chatbot-box" role="dialog" aria-modal="false" aria-labelledby="chatTitle">
      <div class="chat-header" id="chatTitle">Asistente</div>
      <div id="chatbot-messages"></div>
      <div class="chat-input-row">
        <input type="text" id="chatbot-input" placeholder="Escribe aqu√≠..." />
        <button id="chatbot-send" aria-label="Enviar mensaje">‚û§</button>
      </div>
    </div>
  </div>

  <script>
    // ===== Utilidades =====
    const $ = (sel) => document.querySelector(sel);
    const alertBox = $('#form-alert');
    const form = $('#signin-form');
    const emailEl = $('#email');
    const passEl = $('#password');
    const submitBtn = $('#submit-btn');
    const toggleBtn = document.querySelector('.toggle-pass');

    // Mostrar / Ocultar contrase√±a
    toggleBtn.addEventListener('click', () => {
      const esPwd = passEl.type === 'password';
      passEl.type = esPwd ? 'text' : 'password';
      toggleBtn.innerHTML = esPwd
        ? '<i class="fa-regular fa-eye-slash"></i>'
        : '<i class="fa-regular fa-eye"></i>';
    });

    // Validaci√≥n r√°pida
    function mostrarAlerta(msg, ok=false){
      alertBox.textContent = msg;
      alertBox.classList.toggle('ok', ok);
      alertBox.style.display = 'block';
    }
    function limpiarAlerta(){
      alertBox.style.display = 'none';
      alertBox.classList.remove('ok');
      alertBox.textContent = '';
    }
    function emailPareceValido(email){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    // Env√≠o del formulario (demo + hook para backend)
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      limpiarAlerta();

      const email = emailEl.value.trim();
      const password = passEl.value;

      // Validaciones m√≠nimas
      if (!email || !emailPareceValido(email)){
        mostrarAlerta('Introduce un correo electr√≥nico v√°lido.');
        emailEl.focus(); return;
      }
      if (!password || password.length < 6){
        mostrarAlerta('La contrase√±a debe tener al menos 6 caracteres.');
        passEl.focus(); return;
      }

      // UI: bloquea bot√≥n
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Iniciando‚Ä¶';

      try{
        // ===== OPCI√ìN A: Demo (sin backend) =====
        await new Promise(r => setTimeout(r, 600));
        if (document.getElementById('remember').checked) {
          localStorage.setItem('ng_remember', email);
        } else {
          localStorage.removeItem('ng_remember');
        }
        mostrarAlerta('Inicio de sesi√≥n correcto. Redirigiendo‚Ä¶', true);
        window.location.href = 'esp-dashboard.html';
        return;

        // ===== OPCI√ìN B: Conectar a tu backend (descomenta y ajusta) =====
        /*
        const res = await fetch('/api/auth/signin', {
          method:'POST',
          headers:{ 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password, remember: document.getElementById('remember').checked })
        });
        if(!res.ok){
          const err = await res.json().catch(()=>({message:'Credenciales inv√°lidas'}));
          throw new Error(err.message || 'Credenciales inv√°lidas');
        }
        window.location.href = '/dashboard';
        */

        // ===== OPCI√ìN C: Firebase Email/Password (ejemplo) =====
        /*
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = { apiKey:"...", authDomain:"...", projectId:"...", appId:"..." };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const userCred = await signInWithEmailAndPassword(auth, email, password);
        window.location.href = 'esp-dashboard.html';
        */
      } catch(err){
        console.error(err);
        mostrarAlerta(err.message || 'No se pudo iniciar sesi√≥n. Intenta nuevamente.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fa-solid fa-right-to-bracket"></i> Iniciar sesi√≥n';
      }
    });

    // Autocompletar email si qued√≥ guardado (demo)
    (function restaurarRecordado(){
      const v = localStorage.getItem('ng_remember');
      if (v) {
        emailEl.value = v;
        document.getElementById('remember').checked = true;
      }
    })();

    // ===== Chatbot m√≠nimo =====
    const toggle = document.getElementById("chatbot-toggle");
    const box = document.getElementById("chatbot-box");
    const input = document.getElementById("chatbot-input");
    const send = document.getElementById("chatbot-send");
    const messages = document.getElementById("chatbot-messages");

    toggle.addEventListener("click", () => {
      box.style.display = box.style.display === "none" ? "block" : "none";
    });

    function addMsg(who, text){
      const wrap = document.createElement('div');
      wrap.style.marginBottom = '10px';
      wrap.innerHTML = `<strong>${who}:</strong> ${text}`;
      messages.appendChild(wrap);
      messages.scrollTop = messages.scrollHeight;
    }

    send.addEventListener("click", () => {
      const text = input.value.trim();
      if(!text) return;
      addMsg('T√∫', text);
      addMsg('Bot', 'Gracias, tu respuesta est√° en camino.');
      input.value = "";
    });
    input.addEventListener('keydown', (e) => {
      if(e.key === 'Enter'){ e.preventDefault(); send.click(); }
    });
  </script>
</body>
</html>
