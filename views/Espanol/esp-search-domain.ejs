<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buscar Dominio - NameGasmic</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background-color:#0d1b3a; color:white; display:flex; flex-direction:column; min-height:100vh; }
    header { background-color:#0d1b3a; padding:1rem; text-align:center; border-bottom:2px solid #142952; }
    main { flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:1rem; width:100%; max-width:900px; margin:0 auto; }
    h2 { margin-bottom:1rem; }

    .search-box { display:flex; max-width:500px; width:100%; }
    .search-box input { flex:1; padding:0.75rem; font-size:1rem; border:none; border-radius:8px 0 0 8px; outline:none; }
    .btn-search { background-color:#ff9900; border:none; color:white; padding:0 1.5rem; font-size:1rem; cursor:pointer; border-radius:0 8px 8px 0; transition: background-color .3s; }
    .btn-search:hover { background-color:#e68a00; }

    .btn, .btn a { display:inline-block; padding:10px 20px; background:#ffd700; color:#0d1b3a; font-weight:bold; border-radius:8px; text-decoration:none; transition:background .3s; border:none; cursor:pointer; }
    .btn:hover { background:#ffcc00; }

    .result { margin-top:1.5rem; font-size:1.1rem; }
    .muted { color:#ccc; font-size:.9rem; margin-top:.5rem; }

    .pricing-container { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:10px; margin:20px 0; width:100%; }
    .card { background: linear-gradient(135deg, #1e3c72, #2a5298); border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.3); padding:20px; text-align:center; transition: transform .2s; }
    .card:hover { transform: translateY(-5px); }
    .card h2 { margin:0; font-size:16px; color:#fff; }
    .price { font-size:18px; font-weight:bold; margin:15px 0; color:#ffd700; }
    .desc { font-size:12px; margin-bottom:20px; color:#f0f0f0; }

    footer { background-color:#0d1b3a; text-align:center; padding:1rem; border-top:2px solid #142952; font-size:0.9rem; color:#ccc; }

    .lang { position:fixed; top:15px; right:50px; z-index:9999; display:flex; gap:10px; }
    .lang img { width:60px; height:50px; cursor:pointer; display:block; }
  </style>
</head>
<body>

  <!-- Selector de idiomas (ES -> EN) -->
  <div class="lang" aria-label="Language selector">
    <a href="/en/search-domain" title="English">
      <img src="/bandera-uk.png" alt="English">
    </a>
  </div>

  <header>
    <h1>NameGasmic ‚Äî Buscar Dominio</h1>
  </header>

  <main>
    <h2>Escribe tu dominio</h2>

    <div class="search-box">
      <input type="text" id="domainInput" placeholder="ej. ejemplo.com" />
      <button class="btn-search" id="btnSearch">Buscar</button>
    </div>

    <div class="muted">Plan gratis: 3 consultas por d√≠a. Te mostraremos el cupo restante despu√©s de cada b√∫squeda.</div>

    <div style="margin-top: 1rem;">
      <a class="btn" href="/es/esp-namegasm-pagina-inicial-basica">Inicio</a>
    </div>

    <div id="result" class="result"></div>

    <div class="pricing-container">
      <div class="card">
        <h2>B√°sico</h2>
        <p class="price">Gratis</p>
        <p class="desc">B√∫squedas de dominios limitadas por d√≠a (3 diarias).</p>
        <a href="#" class="btn">Comenzar</a>
      </div>

      <div class="card">
        <h2>Premium</h2>
        <p class="price">6 ‚Ç¨/mes</p>
        <p class="desc">B√∫squedas ilimitadas, historial y sugerencias personalizadas.</p>
        <a href="#" class="btn">Suscribirse</a>
      </div>

      <div class="card">
        <h2>Dominios</h2>
        <p class="price">Desde 66 ‚Ç¨/a√±o</p>
        <p class="desc">Registra tu dominio en extensiones cl√°sicas y nuevas.</p>
        <a href="#" class="btn">Registrar</a>
      </div>
    </div>
  </main>

  <!-- Chatbot -->
  <div id="chatbot-container" style="position:fixed; bottom:3px; right:20px; z-index:9999;">
    <button id="chatbot-toggle" style="background:#0073e6; color:#fff; border:none; padding:12px 18px; border-radius:50px; cursor:pointer; box-shadow:0px 4px 8px rgba(0,0,0,0.2);">
      üí¨ Chat
    </button>
    <div id="chatbot-box" style="display:none; width:300px; height:400px; background:#fff; border-radius:12px; box-shadow:0px 4px 10px rgba(0,0,0,0.3); position:absolute; bottom:60px; right:0; overflow:hidden;">
      <div style="background:#0073e6; color:white; padding:10px; font-weight:bold;">Asistente</div>
      <div id="chatbot-messages" style="height:300px; overflow-y:auto; padding:10px; font-size:14px;"></div>
      <div style="display:flex; border-top:1px solid #ccc;">
        <input type="text" id="chatbot-input" placeholder="Escribe aqu√≠..." style="flex:1; border:none; padding:10px; font-size:14px;">
        <button id="chatbot-send" style="background:#0073e6; color:#fff; border:none; padding:10px; cursor:pointer;">‚û§</button>
      </div>
    </div>
  </div>

  <footer>
    &copy; 2025 NameGasmic. Todos los derechos reservados.
  </footer>

  <script>
    // --- Validaci√≥n + endpoint gratuito / cuota ---
    function esDominioValido(d) {
      const s = (d || "").trim().toLowerCase();
      if (!s || s.length > 253 || s.includes("..")) return false;
      const re = /^([a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)(\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)+$/i;
      return re.test(s);
    }

    async function buscarDominio() {
      const input = document.getElementById('domainInput');
      const resultDiv = document.getElementById('result');
      const domain = input.value.trim();

      if (!esDominioValido(domain)) {
        resultDiv.textContent = "Por favor escribe un dominio v√°lido (ej. ejemplo.com).";
        resultDiv.style.color = "yellow";
        return;
      }

      resultDiv.textContent = "Comprobando‚Ä¶";
      resultDiv.style.color = "#fff";

      try {
        const response = await fetch("/api/search-domain-free", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ domain })
        });

        const data = await response.json().catch(()=>({}));
        const remain = response.headers.get("X-Remaining");
        const limit  = response.headers.get("X-Daily-Limit");

        if (response.ok) {
          const disponibilidad = data.available ? "Disponible" : "No disponible";
          resultDiv.innerHTML = `
            <div>Dominio: <strong>${data.domain}</strong></div>
            <div>Estado: <strong style="color:${data.available ? 'lightgreen' : 'red'}">${disponibilidad}</strong></div>
            ${remain !== null && limit !== null ? `<div class="muted">Cupo diario: ${remain}/${limit} restantes</div>` : ''}
          `;
        } else {
          resultDiv.textContent = (data && data.error) ? data.error : "Error en la b√∫squeda.";
          resultDiv.style.color = "red";
        }
      } catch (err) {
        console.error("Error:", err);
        resultDiv.textContent = "Servidor no disponible.";
        resultDiv.style.color = "red";
      }
    }

    document.getElementById('btnSearch').addEventListener('click', buscarDominio);
    document.getElementById('domainInput').addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') { e.preventDefault(); buscarDominio(); }
    });

    // --- Chatbot ---
    (function(){
      const toggle = document.getElementById("chatbot-toggle");
      const box = document.getElementById("chatbot-box");
      const input = document.getElementById("chatbot-input");
      const send = document.getElementById("chatbot-send");
      const messages = document.getElementById("chatbot-messages");

      if(!toggle || !box) return;

      toggle.addEventListener("click", () => {
        box.style.display = (box.style.display === "none" || !box.style.display) ? "block" : "none";
      });

      function addMsg(who, text){
        const wrap = document.createElement('div');
        wrap.style.marginBottom = '10px';
        wrap.innerHTML = "<strong>"+who+":</strong> " + text;
        messages.appendChild(wrap);
        messages.scrollTop = messages.scrollHeight;
      }

      send.addEventListener("click", () => {
        const text = (input.value || "").trim();
        if(!text) return;
        addMsg('T√∫', text);
        addMsg('Bot', '¬°Gracias! Te responderemos pronto.');
        input.value = "";
      });
    })();
  </script>
</body>
</html>

